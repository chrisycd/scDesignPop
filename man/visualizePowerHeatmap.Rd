% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/powerAnalysis.R
\name{visualizePowerHeatmap}
\alias{visualizePowerHeatmap}
\title{Visualize power as heatmaps across study designs}
\usage{
visualizePowerHeatmap(
  power_result,
  nindiv_col = "nindiv",
  ncell_col = "ncell",
  x_facet = "celltype",
  y_facet = "method",
  power_col = "power",
  fill_label = "Power",
  fill_limits = c(0, 1),
  facet_scales = "fixed",
  base_size = 6
)
}
\arguments{
\item{power_result}{A data frame containing the power estimates
to be visualized. It must include columns for the number of individuals,
number of cells per individual, the faceting variables, and the power
values. See \code{nindiv_col}, \code{ncell_col}, \code{x_facet},
\code{y_facet}, and \code{power_col}.}

\item{nindiv_col}{A character string specifying the column in
\code{power_result} that stores the number of individuals in each design
setting. This column will be mapped to the x-axis (after being converted
to a factor).}

\item{ncell_col}{A character string specifying the column in
\code{power_result} that stores the number of cells per individual in each
design setting. This column will be mapped to the y-axis (after being
converted to a factor).}

\item{x_facet}{A character string specifying the column in
\code{power_result} to use for the row-wise facet (the left-to-right
“strips” in \code{facet_grid}). Typically this can be the cell types or genes.}

\item{y_facet}{A character string specifying the column in
\code{power_result} to use for the column-wise facet (the top-to-bottom
“strips” in \code{facet_grid}). Typically this can be the methods.}

\item{power_col}{A character string specifying the column in
\code{power_result} that contains the power values.}

\item{fill_label}{A character string giving the label for the fill legend
(e.g., \code{"Power"}).}

\item{fill_limits}{A numeric vector of length two giving the lower and upper
limits of the fill scale (e.g., \code{c(0, 1)}). Set to \code{NULL} to let
\pkg{ggplot2} choose the limits automatically based on the data.}

\item{facet_scales}{A character string passed to the \code{scales} argument
of \code{ggplot2::facet_grid}. Must be one of \code{"fixed"},
\code{"free"}, \code{"free_x"}, or \code{"free_y"}, controlling whether the
axes are shared or allowed to vary across facets.}

\item{base_size}{Numeric; base font size passed to
\code{ggplot2::theme_minimal} to control overall text size in the plot.}
}
\value{
A \code{ggplot} object representing the faceted power heatmap.
}
\description{
Create a faceted heatmap showing statistical power across combinations of
numbers of individuals and numbers of cells per individual, optionally
stratified by method, cell types and genes (gene-SNP pairs).
}
\examples{
# Example toy data for power heatmap
toy_df <- data.frame(
  nindiv   = rep(c(50, 50, 100, 100, 200, 200), times = 4),
  ncell    = rep(c(500, 1000, 500, 1000, 500, 1000), times = 4),
  method   = rep(c("model1", "model2","model1", "model2"), each = 6),
  celltype = rep(c("Bcell", "Tcell"), each = 12),
  power    = runif(24, 0, 1)
)

# Visualize power heatmap
visualizePowerHeatmap(
  power_result = toy_df,
  nindiv_col   = "nindiv",
  ncell_col    = "ncell",
  x_facet      = "celltype",
  y_facet      = "method",
  power_col    = "power"
)

}
